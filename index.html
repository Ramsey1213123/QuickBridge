<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>QuickBridge â€” Phone â†” Computer Transfer</title>
  <style>
    :root{--bg:#0b0b10;--card:#0f1116;--muted:#9aa0a6;--accent:#ffd166;--glass:rgba(255,255,255,0.03);--radius:14px}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial}
    html,body{height:100%;margin:0;background:linear-gradient(180deg,#07070a 0%, #0b0b10 100%);color:#e6eef3}
    .container{max-width:1100px;margin:36px auto;padding:28px;}
    header{display:flex;align-items:center;gap:18px}
    .logo{width:56px;height:56px;background:linear-gradient(135deg,#ffd166,#ff6b6b);border-radius:12px;display:grid;place-items:center;font-weight:700;color:#0b0b10}
    h1{margin:0;font-size:20px}
    p.lead{margin:4px 0 0;color:var(--muted);font-size:13px}

    .grid{display:grid;grid-template-columns:1fr 420px;gap:20px;margin-top:22px}
    .card{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 6px 30px rgba(2,6,23,0.6);}

    /* Upload area */
    .drop{border:2px dashed rgba(255,255,255,0.06);padding:28px;border-radius:12px;min-height:220px;display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center;background:linear-gradient(180deg,transparent,rgba(255,255,255,0.01))}
    .drop.dragover{border-color:rgba(255,255,255,0.14);background:linear-gradient(180deg,rgba(255,255,255,0.01),rgba(255,255,255,0.02))}
    .drop .big{font-size:15px;color:var(--muted)}
    .controls{display:flex;gap:10px}
    button{background:var(--glass);border:1px solid rgba(255,255,255,0.03);color:inherit;padding:8px 12px;border-radius:9px;cursor:pointer}
    .btn-primary{background:linear-gradient(90deg,#ffd166,#ff7b7b);color:#0b0b10;border:none}

    /* File list */
    .file-list{margin-top:14px;display:flex;flex-direction:column;gap:8px;max-height:260px;overflow:auto;padding-right:6px}
    .file-row{display:flex;gap:12px;align-items:center;padding:8px;border-radius:10px;background:rgba(255,255,255,0.01);}
    .f-icon{width:44px;height:44px;border-radius:8px;display:grid;place-items:center;background:rgba(0,0,0,0.25);font-size:14px}
    .f-meta{flex:1;min-width:0}
    .fname{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .fmeta{font-size:12px;color:var(--muted)}
    .f-actions{display:flex;gap:8px}

    /* Right column */
    .box{display:flex;flex-direction:column;gap:12px}
    textarea{width:100%;min-height:160px;background:transparent;border:1px solid rgba(255,255,255,0.03);padding:12px;border-radius:10px;color:inherit;font-size:14px}
    .mini{font-size:13px;color:var(--muted)}
    .row{display:flex;gap:10px;align-items:center}

    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

    /* small */
    @media (max-width:980px){.grid{grid-template-columns:1fr;}
      .container{padding:18px}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">QB</div>
      <div>
        <h1>QuickBridge</h1>
        <p class="lead">Easily move files & text between your phone and computer â€” drag & drop, copy, download, or scan a QR.</p>
      </div>
    </header>

    <main class="grid">
      <section class="card">
        <div id="drop" class="drop">
          <div class="big">Drag & drop files here</div>
          <div class="mini">or</div>
          <div class="controls">
            <label style="display:inline-block">
              <input id="fileInput" type="file" multiple style="display:none"> 
              <button>Choose files</button>
            </label>
            <button id="clearAll">Clear all</button>
          </div>
          <div class="mini">Tip: open this page on both devices to download files to the other device after transferring (see how below).</div>
        </div>

        <div class="file-list card" id="fileList" style="margin-top:14px;padding:12px;background:transparent;border-radius:12px">
          <!-- dynamic -->
        </div>
      </section>

      <aside class="card">
        <div class="box">
          <div>
            <div class="mini">Quick text bridge</div>
            <textarea id="textArea" placeholder="Paste text here â€” tap 'Save' then open this page on your other device and press 'Load' to retrieve it."></textarea>
            <div class="row">
              <button id="saveText">Save</button>
              <button id="loadText">Load</button>
              <button id="copyText">Copy to clipboard</button>
              <button id="qrText">Generate QR</button>
            </div>
            <div id="qrWrap" style="display:none;margin-top:10px;">
              <div class="mini">Scan this QR on another device:</div>
              <canvas id="qrCanvas" style="margin-top:8px;border-radius:8px;background:white;padding:6px"></canvas>
            </div>
          </div>

          <div>
            <div class="mini">Saved items (persisted in your browser)</div>
            <div id="savedList" style="max-height:150px;overflow:auto;margin-top:8px;display:flex;flex-direction:column;gap:8px"></div>
          </div>

          <div style="margin-top:6px;color:var(--muted);font-size:12px">Notes: Files are stored in your browser (IndexedDB). To transfer between devices, open this same page on the other device and use "Download" or scan the QR. For large files or constant sync you'll want a tiny cloud backend (I can recommend free options â€” which kind of cloud DB do you want?).</div>
        </div>
      </aside>
    </main>

    <footer>Made for quick transfers â€¢ Files kept locally unless you choose to export</footer>
  </div>

<script>
// Minimal app: drag & drop + store files in IndexedDB, list files with download & copy options.
// NOTE: This is client-only. To sync between devices you can either open this page on the other device and download files, or use a cloud DB/backend.

// ---- tiny IndexedDB helper ----
function idbOpen(name='quickbridge', store='files'){
  return new Promise((res,rej)=>{
    const r = indexedDB.open(name,1);
    r.onupgradeneeded = ()=>{ r.result.createObjectStore(store,{keyPath:'id'}); };
    r.onsuccess = ()=>res(r.result);
    r.onerror = ()=>rej(r.error);
  })
}
async function idbPut(obj){ const db = await idbOpen(); const tx = db.transaction('files','readwrite'); tx.objectStore('files').put(obj); return new Promise((r,rej)=>{tx.oncomplete=()=>r(true);tx.onerror=()=>rej(tx.error)}); }
async function idbGetAll(){ const db = await idbOpen(); const tx = db.transaction('files','readonly'); const req = tx.objectStore('files').getAll(); return new Promise((r,rej)=>{req.onsuccess=()=>r(req.result);req.onerror=()=>rej(req.error)}); }
async function idbDelete(id){ const db = await idbOpen(); const tx = db.transaction('files','readwrite'); tx.objectStore('files').delete(id); return new Promise((r,rej)=>{tx.oncomplete=()=>r(true);tx.onerror=()=>rej(tx.error)}); }
async function idbClear(){ const db = await idbOpen(); const tx = db.transaction('files','readwrite'); tx.objectStore('files').clear(); return new Promise((r,rej)=>{tx.oncomplete=()=>r(true);tx.onerror=()=>rej(tx.error)}); }

// ---- app logic ----
const drop = document.getElementById('drop');
const fileInput = document.getElementById('fileInput');
const fileList = document.getElementById('fileList');
const savedList = document.getElementById('savedList');
const clearAllBtn = document.getElementById('clearAll');

function iconForName(name){ const ext = (name.split('.').pop()||'').toLowerCase(); if(['png','jpg','jpeg','gif','webp','svg'].includes(ext)) return 'ðŸ–¼ï¸';
 if(['mp3','wav','flac','m4a','ogg'].includes(ext)) return 'ðŸŽµ';
 if(['mp4','mov','webm','mkv'].includes(ext)) return 'ðŸŽ¬';
 if(['pdf'].includes(ext)) return 'ðŸ“„';
 if(['zip','rar','7z','gz'].includes(ext)) return 'ðŸ—œï¸';
 if(['doc','docx','odt'].includes(ext)) return 'ðŸ“ƒ';
 if(['txt','md','json','csv'].includes(ext)) return 'ðŸ“„';
 return 'ðŸ“'; }

function makeFileRow(item){ const row = document.createElement('div'); row.className='file-row';
  const icon = document.createElement('div'); icon.className='f-icon'; icon.textContent = iconForName(item.name);
  const meta = document.createElement('div'); meta.className='f-meta';
  const fname = document.createElement('div'); fname.className='fname'; fname.textContent = item.name;
  const fmeta = document.createElement('div'); fmeta.className='fmeta'; fmeta.textContent = `${Math.round(item.size/1024)} KB â€” ${new Date(item.added).toLocaleString()}`;
  meta.appendChild(fname); meta.appendChild(fmeta);

  const actions = document.createElement('div'); actions.className='f-actions';
  const dl = document.createElement('button'); dl.textContent='Download'; dl.onclick = ()=>{ const blob = new Blob([item.data], {type:item.type}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href=url; a.download=item.name; document.body.appendChild(a); a.click(); a.remove(); setTimeout(()=>URL.revokeObjectURL(url),5000); };
  const copyBtn = document.createElement('button'); copyBtn.textContent='Copy'; copyBtn.onclick = async ()=>{
    try{
      const blob = new Blob([item.data], {type:item.type});
      // try clipboard write (only works for certain types and secure contexts)
      if(navigator.clipboard && navigator.clipboard.write){
        const clipboardItem = new ClipboardItem({[item.type]: blob});
        await navigator.clipboard.write([clipboardItem]);
        alert('File copied to system clipboard (if supported by your browser). Paste on the other device/app.');
      } else {
        // fallback: download
        alert('Clipboard write not supported. Use Download button to transfer or open this page on the other device.');
      }
    }catch(e){ alert('Could not copy file to clipboard: ' + e.message); }
  };
  const del = document.createElement('button'); del.textContent='Delete'; del.onclick = async ()=>{ if(confirm('Delete this saved file?')){ await idbDelete(item.id); renderAll(); }};
  actions.appendChild(dl); actions.appendChild(copyBtn); actions.appendChild(del);

  row.appendChild(icon); row.appendChild(meta); row.appendChild(actions);
  return row;
}

async function renderAll(){ fileList.innerHTML=''; const all = await idbGetAll(); if(all.length===0){ fileList.innerHTML='<div class="mini" style="padding:12px;color:var(--muted)">No files saved. Drop files or choose files above.</div>'; } else {
    all.sort((a,b)=>b.added-a.added).forEach(it=> fileList.appendChild(makeFileRow(it)));
  }
  // saved list (compact)
  savedList.innerHTML=''; const text = localStorage.getItem('qb_text'); const tdiv = document.createElement('div'); tdiv.className='file-row'; tdiv.style.padding='8px'; tdiv.innerHTML=`<div style="flex:1"><div class="fname">Saved text</div><div class="fmeta">${text?text.slice(0,80):'<empty>'}</div></div>`; const ld = document.createElement('button'); ld.textContent='Load'; ld.onclick = ()=>{ document.getElementById('textArea').value = text||''; }; const cp = document.createElement('button'); cp.textContent='Copy'; cp.onclick = ()=>{ navigator.clipboard.writeText(text||''); alert('Copied text to clipboard'); };
  const clr = document.createElement('button'); clr.textContent='Clear'; clr.onclick = ()=>{ if(confirm('Clear saved text?')){ localStorage.removeItem('qb_text'); renderAll(); }};
  const actions = document.createElement('div'); actions.className='f-actions'; actions.appendChild(ld); actions.appendChild(cp); actions.appendChild(clr);
  tdiv.appendChild(actions); savedList.appendChild(tdiv);
}

// handle file add
async function addFiles(files){ for(const f of files){ const arr = await f.arrayBuffer(); const id = crypto.randomUUID(); const obj = {id, name:f.name, type:f.type||'application/octet-stream', size:arr.byteLength, data:arr, added:Date.now()}; await idbPut(obj); }
  renderAll(); }

// drag & drop
['dragenter','dragover'].forEach(ev=> drop.addEventListener(ev,e=>{ e.preventDefault(); e.stopPropagation(); drop.classList.add('dragover'); }));
['dragleave','drop'].forEach(ev=> drop.addEventListener(ev,e=>{ e.preventDefault(); e.stopPropagation(); drop.classList.remove('dragover'); }));
drop.addEventListener('drop', async (e)=>{ const files = Array.from(e.dataTransfer.files); if(files.length) await addFiles(files); });
fileInput.addEventListener('change', async(e)=>{ if(e.target.files.length) await addFiles(Array.from(e.target.files)); fileInput.value=''; });
clearAllBtn.addEventListener('click', async ()=>{ if(confirm('Clear all saved files?')){ await idbClear(); renderAll(); }});

// text area actions
const textArea = document.getElementById('textArea');
document.getElementById('saveText').addEventListener('click', ()=>{ localStorage.setItem('qb_text', textArea.value); renderAll(); alert('Text saved locally â€” open this page on the other device and press Load to retrieve it.'); });

document.getElementById('loadText').addEventListener('click', ()=>{ const t = localStorage.getItem('qb_text')||''; textArea.value = t; alert('Loaded text from local storage'); });

document.getElementById('copyText').addEventListener('click', async ()=>{ try{ await navigator.clipboard.writeText(textArea.value); alert('Text copied to clipboard'); }catch(e){ alert('Failed to copy: ' + e.message); } });

// QR generation for text (tiny QR implementation: using library-free method - we will encode text into a data: URL and draw a QR using canvas fallback: show the text as blob link and small QR via external library is not allowed offline. We provide a basic fallback: display text as downloadable file and a data-URI preview.)
const qrWrap = document.getElementById('qrWrap'); const qrCanvas = document.getElementById('qrCanvas');

document.getElementById('qrText').addEventListener('click', ()=>{
  const text = textArea.value.trim(); if(!text){ alert('Enter text first'); return; }
  // fallback: draw a simple text preview on the canvas and provide a downloadable TXT â€” real QR requires external lib; keep simple but useful.
  qrWrap.style.display='block'; const ctx = qrCanvas.getContext('2d'); qrCanvas.width = 300; qrCanvas.height = 300; ctx.fillStyle = '#ffffff'; ctx.fillRect(0,0,qrCanvas.width,qrCanvas.height); ctx.fillStyle = '#000000'; ctx.font = '12px monospace'; const lines = text.split('\n'); let y=18; for(const line of lines.slice(0,18)){ ctx.fillText(line.slice(0,40),8,y); y+=14; }
  // create download link below canvas
  let link = document.getElementById('qrDownloadLink'); if(link) link.remove(); link = document.createElement('a'); link.id='qrDownloadLink'; link.textContent='Download text file'; const blob = new Blob([text],{type:'text/plain'}); link.href = URL.createObjectURL(blob); link.download='quickbridge.txt'; link.style.display='inline-block'; link.style.marginTop='8px'; qrWrap.appendChild(link);
});

// init
renderAll();

// On first load, show short instructions if coming from mobile
if(/Mobi|Android/i.test(navigator.userAgent)){
  console.log('mobile');
}

</script>
</body>
</html>
