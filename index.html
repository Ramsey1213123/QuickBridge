<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>QuickBridge</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: radial-gradient(circle at 20% 20%, #ffafbd, #ffc3a0, #d4fc79, #96e6a1, #a1c4fd, #c2e9fb);
    background-size: 400% 400%;
    animation: gradientMove 15s ease infinite;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
  }
  @keyframes gradientMove {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  .container {
    backdrop-filter: blur(20px);
    background: rgba(255, 255, 255, 0.2);
    border-radius: 20px;
    padding: 30px;
    width: 90%;
    max-width: 800px;
    box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    color: #fff;
  }
  h1 {
    text-align: center;
    font-size: 2em;
    margin-bottom: 20px;
  }
  section {
    margin-bottom: 30px;
  }
  input[type="file"], textarea {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 12px;
    margin-bottom: 10px;
    font-size: 1em;
  }
  button {
    background: rgba(255,255,255,0.2);
    color: #fff;
    border: none;
    padding: 10px 20px;
    margin-right: 5px;
    border-radius: 12px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background: rgba(255,255,255,0.4);
  }
  .file-list, .text-display {
    margin-top: 10px;
  }
  .file-item {
    display: flex;
    justify-content: space-between;
    background: rgba(255,255,255,0.1);
    padding: 8px;
    border-radius: 8px;
    margin-bottom: 5px;
  }
</style>
</head>
<body>

<div class="container">
  <h1>QuickBridge</h1>

  <!-- File Upload Section -->
  <section>
    <h2>Files</h2>
    <input type="file" id="fileInput">
    <button onclick="uploadFile()">Upload File</button>
    <div class="file-list" id="fileList"></div>
  </section>

  <!-- Text Section -->
  <section>
    <h2>Text</h2>
    <textarea id="textInput" rows="4" placeholder="Type or paste your text here..."></textarea><br>
    <button onclick="saveText()">Save Text</button>
    <button onclick="copyText()">Copy Text</button>
    <button onclick="downloadText()">Download as .txt</button>
    <div class="text-display" id="textDisplay"></div>
  </section>
</div>

<script>
  const SUPABASE_URL = "https://nuyctnaioepalgytinwd.supabase.co";
  const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51eWN0bmFpb2VwYWxneXRpbndkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3NjgzMDYsImV4cCI6MjA3MDM0NDMwNn0.rZ_IQR8EqVaMIuM3nSpzY5bIXRREXRaClcQS7Tmw6yI";
  const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  async function listFiles() {
    const { data, error } = await supabase.storage.from('quickbridge').list();
    if (error) { console.error(error); return; }
    const fileList = document.getElementById('fileList');
    fileList.innerHTML = '';
    data.forEach(file => {
      const url = `${SUPABASE_URL}/storage/v1/object/public/quickbridge/${file.name}`;
      fileList.innerHTML += `
        <div class="file-item">
          <span>${file.name}</span>
          <a href="${url}" download>Download</a>
        </div>
      `;
    });
  }

  async function uploadFile() {
    const file = document.getElementById('fileInput').files[0];
    if (!file) return alert("Select a file first");
    const { error } = await supabase.storage.from('quickbridge').upload(file.name, file, { upsert: true });
    if (error) {
      alert("Upload failed");
      console.error(error);
    } else {
      alert("File uploaded");
      listFiles();
    }
  }

  async function saveText() {
    const content = document.getElementById('textInput').value;
    if (!content.trim()) return alert("Enter some text first");
    const { error } = await supabase.from('text').upsert([{ id: 1, content }]);
    if (error) {
      console.error(error);
      alert("Failed to save text");
    } else {
      alert("Text saved");
      loadText();
    }
  }

  async function loadText() {
    const { data, error } = await supabase.from('text').select('content').eq('id', 1).single();
    if (error) {
      console.error(error);
      return;
    }
    document.getElementById('textDisplay').innerHTML = `<pre>${data.content || ''}</pre>`;
  }

  function copyText() {
    const text = document.getElementById('textInput').value;
    navigator.clipboard.writeText(text);
    alert("Text copied to clipboard");
  }

  function downloadText() {
    const text = document.getElementById('textInput').value;
    const blob = new Blob([text], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = "quickbridge.txt";
    a.click();
    URL.revokeObjectURL(url);
  }

  listFiles();
  loadText();
</script>
</body>
</html>
